import os

text_file = open("unique_malware_permission.txt", "r")    #getting unique permission from unique_permission_malware.ext file which 
malware = text_file.readlines()
text_file.close()
text_file = open("unique_beningn_permission.txt", "r")    #getting unique permission from unique_permission_beningn.ext file which 
beningn = text_file.readlines()
perm=malware+beningn                                    #Combining benign and malware unique permission list
text_file.close()
unique_perm = set(perm)

text_file = open("malware_frequency.txt", "r")  #malware frequency table
malware_freq = text_file.readlines()
text_file = open("beningn_frequency.txt", "r")  #benign frequency table
beningn_freq = text_file.readlines()

beningn_present=0
malware_present=0
Dataset_folder_path = 'D:\Complete_Ans\Shahzad Alam(16IT08F)\Malware'
filename = os.listdir(Dataset_folder_path)
file_length=len(filename)

#path, dirs, files = os.walk("D:\Complete_Ans\Shahzad Alam(16IT08F)\Malware").next()
#file_count = len(files)

with open('contengency_table.txt','w+') as op:   #creating contengency table
 for perm in unique_perm:
  f_perm=perm.split('\n')
  for m_freq in malware_freq :
    data=m_freq.split('\t')
    count=data[1].split('\n')
   
    if(f_perm[0]==data[0]):        #checking malware is present or not
      malware_present=count[0]

  for b_freq in beningn_freq :
    data1=b_freq.split('\t')
    count1=data1[1].split('\n')
  
    if(f_perm[0]==data1[0]):       #checking benign is present or not
      beningn_present=count1[0]

  op.write('{0} [{1},{2},{3},{4}]'.format(f_perm[0] ,int(beningn_present),(file_length-int(beningn_present)),malware_present,(file_length-int(malware_present)))) 
  op.write('\n')
  print('{0} [{1},{2},{3},{4}]'.format(f_perm[0] ,int(beningn_present),(file_length-int(beningn_present)),malware_present,(file_length-int(malware_present)))) 
  
  


