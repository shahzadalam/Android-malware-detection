from sklearn import svm
import warnings
warnings.filterwarnings("ignore")
# Training data
X = []
Y = []
with open('complete_train_file.csv','r') as fp:    #filename for training data
    for i,line in enumerate(fp):
        if i == 0:
            pass
        else:
            X.append([int(x) for x in line.split(',')[1:]])
            Y.append(0 if line.split(',')[0] == "malware" else 1)


# Testing Data
X_test = []
Y_test = []
with open('test.csv','r') as fp:      #filename for testing data
    for i,line in enumerate(fp): 
        if i == 0:
            pass
        else:
            X_test.append([int(x) for x in line.split(',')[1:]])
            Y_test.append(0 if line.split(',')[0] == "malware" else 1)
print('----------------------------------------------------------------')
print('Total number of instances ',len(Y_test))
print('----------------------------------------------------------------')


# Training data
clf = svm.SVC()
clf.set_params(kernel='rbf').fit(X,Y) 

#Here we are printing the missclassifier instances
count=0;
for i in range(0,len(Y_test)):
    if(clf.predict(X_test[i])!=Y_test[i]): 
        count=count+1
        print(X_test[i])
        print('Actual class :[',Y_test[i],']\t Predicted :',clf.predict(X_test[i]))

#Accuracy calculation
print('----------------------------------------------------------------')
print('Accuracy :',100-((count/len(Y_test))*100),'%')
print('----------------------------------------------------------------')
#print ('Accuracy: {:.3f}%'.format(clf.score(X_test, Y_test)*100))
